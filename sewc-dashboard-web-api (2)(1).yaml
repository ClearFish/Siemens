openapi: 3.0.0
info:
  version: '0.2'
  title: SEWC-PCF-Web
servers:
  - url: 'https://api.pcf.sewc.cn/v1'
paths:
  /latest:
    get:
      summary: 'Product endpoint: Returns the latest batch of the product PCF details.'
      operationId: listLatestProductPcfIndividuals
      responses:
        '200':
          description: 'Response: latest product PCF details.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LatestProductPcfIndividualResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /statistics/product:
    get:
      summary: 'Product statistics endpoint: Returns the product statistics of a factory in one year.'
      operationId: getPcfStatistics
      parameters:
        - name: year
          in: query
          description: 'The year.'
          required: true
          schema:
            type: integer
            format: int32
        - name: factory
          in: query
          description: 'The factory name.'
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 'Response: PCF statistics.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatisticsProductResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /statistics/pcftotal:
    get:
      summary: 'PCF statistics endpoint: Returns the PCF statistics of a factory in one year.'
      operationId: getPcfStatisticsTotal
      parameters:
        - name: year
          in: query
          description: 'The year.'
          required: true
          schema:
            type: integer
            format: int32
        - name: factory
          in: query
          description: 'The factory name.'
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 'Response: Total PCF statistics.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatisticsPcfTotalResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /statistics/pcfbyscope:
    get:
      summary: 'Scope PCF statistics endpoint: Returns the PCF statistics of the scopes.'
      operationId: getPcfStatisticsByScope
      parameters:
        - name: year
          in: query
          description: 'The year.'
          required: true
          schema:
            type: integer
            format: int32
        - name: factory
          in: query
          description: 'The factory name.'
          required: true
          schema:
            type: string
        - name: frequency
          in: query
          description: 'The frequency.'
          required: true
          schema:
            $ref: '#/components/schemas/Frequency'
      responses:
        '200':
          description: 'Response: PCF statistics.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatisticsPcfByScopeResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /statistics/pcfbyprocess:
    get:
      summary: 'Process PCF statistics endpoint: Returns the PCF statistics of the processes.'
      operationId: getPcfStatisticsByProcess
      parameters:
        - name: year
          in: query
          description: 'The year.'
          required: true
          schema:
            type: integer
            format: int32
        - name: factory
          in: query
          description: 'The factory name.'
          required: true
          schema:
            type: string
        - name: frequency
          in: query
          description: 'The frequency.'
          required: true
          schema:
            $ref: '#/components/schemas/Frequency'
      responses:
        '200':
          description: 'Response: PCF statistics.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatisticsPcfByProcessResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /statistics/pcfbyproduct:
    get:
      summary: 'Process PCF statistics endpoint: Returns the PCF statistics of each type of product.'
      operationId: getPcfStatisticsByProduct
      parameters:
        - name: year
          in: query
          description: 'The year.'
          required: true
          schema:
            type: integer
            format: int32
        - name: factory
          in: query
          description: 'The factory name.'
          required: true
          schema:
            type: string
        - name: frequency
          in: query
          description: 'The frequency.'
          required: true
          schema:
            $ref: '#/components/schemas/Frequency'
      responses:
        '200':
          description: 'Response: PCF statistics.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatisticsPcfByProductResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /history:
    get:
      summary: 'History PCF endpoint: Returns the history PCF values of the products.'
      operationId: listIndividualPcfOverview
      parameters:
        - name: product_id
          in: query
          description: 'The product ID.'
          required: false
          schema:
            type: string
        - name: start_datetime
          in: query
          description: 'The start Unix epoch time. e.g. 1632399014 stands for the UTC: "Thu, 23 Sep 2021 12:10:14
          GMT" or the local time: "Thu Sep 23 2021 20:10:14 GMT+0800 (CST)".'
          required: false
          schema:
            type: integer
            format: int32
        - name: end_datetime
          in: query
          description: 'The end Unix epoch time. e.g. 1632399014 stands for the UTC: "Thu, 23 Sep 2021 12:10:14 GMT"
          or the local time: "Thu Sep 23 2021 20:10:14 GMT+0800 (CST)".'
          required: false
          schema:
            type: integer
            format: int32
        - name: page_size
          in: query
          description: 'The page size.'
          required: false
          schema:
            type: integer
            format: int32
        - name: page_number
          in: query
          description: 'The page number.'
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 'Response: history PCF values.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndividualPcfOverviewPagedResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /history/details:
    get:
      summary: 'Product PCF endpoint: Returns the PCF values of the product.'
      operationId: getIndividualPcfDetails
      parameters:
        - name: product_id
          in: query
          description: 'The product ID.'
          required: true
          schema:
            type: string
        - name: serial
          in: query
          description: 'The serial of the individual product.'
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 'Response: product PCF values.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndividualPcfDetailsResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
  /history/details/bom:
    get:
      summary: 'Product BOM PCF endpoint: Returns the PCF values of the BOM lines.'
      operationId: getIndividualPcfDetailsBom
      parameters:
        - name: product_id
          in: query
          description: 'The product ID.'
          required: true
          schema:
            type: string
        - name: bom_line_ti
          in: query
          description: 'The BOM Line Ti.'
          required: false
          schema:
            type: string
        - name: suppliers
          in: query
          description: 'The Suppliers.'
          required: false
          schema:
            type: string
        - name: page_size
          in: query
          description: 'The page size.'
          required: false
          schema:
            type: integer
            format: int32
        - name: page_number
          in: query
          description: 'The page number.'
          required: false
          schema:
            type: integer
            format: int32
      responses:
        '200':
          description: 'Response: Scope 1 and scope 2 values of the product from the start_datetime.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/IndividualPcfDetailsBomPagedResponse'
        default:
          description: 'Unexpected error'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
components:
  schemas:
    LatestProductPcfIndividualResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          type: array
          items:
            $ref: '#/components/schemas/LatestProductPcfIndividual'
    LatestProductPcfIndividual:
      type: object
      required:
        - product_id
        - product_name
        - serial
        - scope1
        - scope2
        - scope3
      properties:
        product_id:
          description: 'Product ID.'
          type: string
        product_name:
          description: 'Product name.'
          type: string
        serial:
          description: 'Product serial number.'
          type: string
        scope1:
          description: 'Scope 1 value of an individual product.'
          type: number
        scope2:
          $ref: '#/components/schemas/ProcessPcfScope12'
        scope3:
          description: 'Scope 3 values of an individual product.'
          type: array
          items:
            $ref: '#/components/schemas/MaterialPcfScope3'
    StatisticsProductResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/StatisticsProduct'
    StatisticsProduct:
      type: object
      required:
        - year
        - factory
        - module_count
        - product_count
        - component_count
        - supplier_count
      properties:
        year:
          description: 'The year.'
          type: integer
          format: int32
        factory:
          description: 'The factory.'
          type: string
        module_count:
          description: 'The count of the modules.'
          type: integer
          format: int32
        product_count:
          description: 'The total product count.'
          type: integer
          format: int32
        component_count:
          description: 'The total component count.'
          type: integer
          format: int32
        supplier_count:
          description: 'The supplier count.'
          type: integer
          format: int32
    StatisticsPcfTotalResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/StatisticsPcfTotal'
    StatisticsPcfTotal:
      type: object
      required:
        - year
        - factory
        - pcf_total
        - pcf_scope12
        - pcf_scope3
      properties:
        year:
          description: 'The year.'
          type: integer
          format: int32
        factory:
          description: 'The factory.'
          type: string
        pcf_total:
          description: 'The total PCF value.'
          type: number
        pcf_scope12:
          $ref: '#/components/schemas/ProcessPcfScope12'
        pcf_scope3:
          description: 'The scope 3 PCF value.'
          type: number
    StatisticsPcfByScopeResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/StatisticsPcfByScope'
    StatisticsPcfByScope:
      type: object
      required:
        - year
        - factory
        - frequency
        - scope12_sequence
        - scope3_sequence
      properties:
        year:
          description: 'The year.'
          type: integer
          format: int32
        factory:
          description: 'The factory.'
          type: string
        frequency:
          $ref: '#/components/schemas/Frequency'
        scope12_sequence:
          description: 'Scope 1&2 emission sequence.'
          type: array
          items:
            type: number
        scope3_sequence:
          description: 'Scope 3 emission sequence.'
          type: array
          items:
            type: number
        periods:
          description: 'The periods.'
          type: array
          items:
            type: string
    StatisticsPcfByProcessResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/StatisticsPcfByProcess'
    StatisticsPcfByProcess:
      type: object
      required:
        - year
        - factory
        - frequency
        - process_pcf_sequence
      properties:
        year:
          description: 'The year.'
          type: integer
          format: int32
        factory:
          description: 'The factory.'
          type: string
        frequency:
          $ref: '#/components/schemas/Frequency'
        process_pcf_sequence:
          description: 'The emission sequence of the process PCF values.'
          type: array
          items:
            $ref: '#/components/schemas/ProcessPcfScope12'
        periods:
          description: 'The periods.'
          type: array
          items:
            type: string
    StatisticsPcfByProductResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/StatisticsPcfByProduct'
    StatisticsPcfByProduct:
      type: object
      required:
        - year
        - factory
        - frequency
        - product_pcf_sequences
      properties:
        year:
          description: 'The year.'
          type: integer
          format: int32
        factory:
          description: 'The factory.'
          type: string
        frequency:
          $ref: '#/components/schemas/Frequency'
        product_pcf_sequences:
          description: 'The products PCF sequences.'
          type: array
          items:
            type: object
            properties:
              product_id:
                description: 'The product ID.'
                type: string
              product_name:
                description: 'The product name.'
                type: string
              product_pcf_sequence:
                description: 'The product PCF sequence.'
                type: array
                items:
                  type: number
                  description: 'The product PCF value'
        periods:
          description: 'The periods.'
          type: array
          items:
            type: string
    IndividualPcfOverviewPagedResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/IndividualPcfOverviewPaged'
    IndividualPcfOverviewPaged:
      type: object
      required:
        - pagination
        - items
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        items:
          description: 'The PCF calculation epoch time.'
          type: array
          items:
            $ref: '#/components/schemas/IndividualPcfOverview'
    IndividualPcfOverview:
      type: object
      required:
        - number
        - product_id
        - serial
        - pcf_calculation_datetime
        - pcf_total
      properties:
        number:
          description: 'The number.'
          type: integer
          format: int32
        product_id:
          description: 'The product ID.'
          type: string
        serial:
          description: 'The product serial number.'
          type: string
        pcf_calculation_datetime:
          description: 'The PCF calculation epoch time.'
          type: string
        pcf_total:
          description: 'The total PCF value.'
          type: number
    IndividualPcfDetailsResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/IndividualPcfDetails'
    IndividualPcfDetails:
      type: object
      required:
        - product_id
        - product_name
        - serial
        - image_url
        - location
        - weight
        - cost
        - pcf_total
      properties:
        product_id:
          description: 'The product ID.'
          type: string
        product_name:
          description: 'The product name.'
          type: string
        serial:
          description: 'The product serial number.'
          type: string
        image_url:
          description: 'The image URL.'
          type: string
        location:
          description: 'The location.'
          type: string
        weight:
          description: 'The weight.'
          type: number
        cost:
          description: 'The cost.'
          type: number
        pcf_total:
          description: 'The total PCF value.'
          type: number
        pcf_scope12:
          $ref: '#/components/schemas/ProcessPcfScope12'
        pcf_scope3:
          description: 'The list of scope 3 PCF value.'
          type: array
          items:
            $ref: '#/components/schemas/MaterialPcfScope3'
    IndividualPcfDetailsBomPagedResponse:
      type: object
      required:
        - code
        - data
      properties:
        code:
          type: integer
          format: int32
        data:
          $ref: '#/components/schemas/IndividualPcfDetailsBomPaged'
    IndividualPcfDetailsBomPaged:
      type: object
      required:
        - pagination
        - items
      properties:
        pagination:
          $ref: '#/components/schemas/Pagination'
        items:
          description: 'The list of BOM line PCF.'
          type: array
          items:
            $ref: '#/components/schemas/IndividualPcfDetailsBomLine'
    IndividualPcfDetailsBomLine:
      type: object
      required:
        - number
        - ti
        - suppliers
        - pcf
      properties:
        number:
          description: 'The BOM line number.'
          type: string
        ti:
          description: 'The BOM line Ti.'
          type: string
        suppliers:
          description: 'The suppliers.'
          type: string
        commodity:
          description: 'The commodity.'
          type: string
        pcf:
          description: 'The PCF value.'
          type: number
        scope1:
          description: 'The scope 1 value.'
          type: number
        scope2:
          description: 'The scope 2 value.'
          type: number
        scope3:
          description: 'The scope 3 value.'
          type: number
        image_url:
          description: 'The material image URL.'
          type: string
    ProcessPcfScope12:
      type: object
      required:
        - public
        - smt
        - tht
        - assembling
      properties:
        public:
          description: 'The public utilities emission.'
          type: number
        smt:
          description: 'The emission in SMT process.'
          type: number
        tht:
          description: 'The emission in THT process.'
          type: number
        assembling:
          description: 'The emission in assembling process.'
          type: number
    MaterialPcfScope3:
      type: object
      required:
        - material_id
        - material_name
        - emission
      properties:
        material_id:
          description: 'The material ID.'
          type: string
        material_name:
          description: 'The material name.'
          type: string
        pcf:
          description: 'The carbon emission value.'
          type: number
        image_url:
          description: 'The image URL.'
          type: string
    Frequency:
      description: 'The statistics frequency.'
      type: string
      enum:
        - 'quarter'
        - 'month'
        - 'day'
    Pagination:
      description: 'The pagination.'
      type: object
      required:
        - page_size
        - page_number
        - page_total
      properties:
        page_size:
          description: 'Current page size.'
          type: integer
          format: int32
        page_number:
          description: 'Current page number.'
          type: integer
          format: int32
        page_total:
          description: 'Total page number.'
          type: integer
          format: int32
    Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: integer
          format: int32
        message:
          type: string
